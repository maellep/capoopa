{{#tpl}}


 <h2><span class="back"><img src="img/back.png"></span> {{ title }} <img src="img/type/{{type}}.png" class="icon" /></h2>
  <div class="inner-content">

    <h3>Informations</h3>
    <ul>
      <li>Catégorie : {{ category }}</li>
      <li>Type : {{ getType type }}</li>
      <!-- <li>Début : {{ date beginning }}</li>
      <li>Durée : {{ time duration }}</li> -->
      <li>Temps restant : {{ timeLeft beginning duration }}</li>
    </ul>

    <h3>Description du défi</h3>
    <p>{{ description }}</p>

    <div>
		<button onclick="takePhoto();" class="button large uploadPhoto">Take Photo</button> <br>
		 <button onclick="capturePhoto();" class="button large uploadPhoto">Capture Photo</button> <br>
		 <button onclick="capturePhotoEdit();" class="button large uploadPhoto">Capture Editable Photo</button> <br>
		 <button onclick="getPhoto(pictureSource.PHOTOLIBRARY);" class="button large uploadPhoto">From Photo Library</button><br>
		 <button onclick="getPhoto(pictureSource.SAVEDPHOTOALBUM);" class="button large uploadPhoto">From Photo Album</button><br>
		 <img style="display:none;width:60px;height:60px;" id="smallImage" src="" />
		 <img style="display:none;" id="largeImage" src="" />
    </div>

  </div>
{{/tpl}}

<script type="text/javascript" charset="utf-8" src="lib/cordova-2.3.0.js"></script>
	
	<script type="text/javascript" charset="utf-8">

    var pictureSource;   // picture source
    var destinationType; // sets the format of returned value 

    // Wait for Cordova to connect with the device
    //
    document.addEventListener("deviceready",onDeviceReady,false);

    // Cordova is ready to be used!
    //
    function onDeviceReady() {
        pictureSource=navigator.camera.PictureSourceType;
        destinationType=navigator.camera.DestinationType;
    }

    // Called when a photo is successfully retrieved
    //
    function onPhotoDataSuccess(imageData) {
      // Uncomment to view the base64 encoded image data
      // console.log(imageData);

      // Get image handle
      //
      var smallImage = document.getElementById('smallImage');

      // Unhide image elements
      //
      smallImage.style.display = 'block';

      // Show the captured photo
      // The inline CSS rules are used to resize the image
      //
      smallImage.src = "data:image/jpeg;base64," + imageData;
	  
	  alert(imageData);
	  
	  	var data = JSON.stringify({
        "answerID":  "/api/core/answer/1/",
        "image": imageData
		});
		
		alert('var data');
		
		postData('photo/', data);
		that.hide();
		
    }

    // Called when a photo is successfully retrieved
    //
    function onPhotoURISuccess(imageURI) {
      // Uncomment to view the image file URI 
      // console.log(imageURI);

      // Get image handle
      //
      var largeImage = document.getElementById('largeImage');

      // Unhide image elements
      //
      largeImage.style.display = 'block';

      // Show the captured photo
      // The inline CSS rules are used to resize the image
      //
      largeImage.src = imageURI;
		
    }

    // A button will call this function
    //
    function capturePhoto() {
      // Take picture using device camera and retrieve image as base64-encoded string
      navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 50,
        destinationType: destinationType.DATA_URL });
    }

    // A button will call this function
    //
    function capturePhotoEdit() {
      // Take picture using device camera, allow edit, and retrieve image as base64-encoded string  
      navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 20, allowEdit: true,
        destinationType: destinationType.DATA_URL });
    }

    // A button will call this function
    //
    function getPhoto(source) {
      // Retrieve image file location from specified source
      navigator.camera.getPicture(onPhotoURISuccess, onFail, { quality: 50, 
        destinationType: destinationType.FILE_URI,
        sourceType: source });
    }

    // Called if something bad happens.
    // 
    function onFail(message) {
      alert('Failed because: ' + message);
    }
	
	function takePhoto(){
				
      var img = "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";

		alert(img);
		
		var data = JSON.stringify({
        "answerID":  "/api/core/answer/1/",
        "image": img
		});
		
		alert('var data');
		
		postData('photo/', data);
		that.hide();
		
		alert('end post photo');
	}

    </script>